# 프로토콜의 이해

## 프로토콜

- 통신을 위해 양 상호간에 지켜야할 약속
- 통신의 두 주체가 같은 프로토콜을 쓴다면, 약속된 규칙으로 통신이 가능하다
- 두 노드가 같은 프로토콜을 사용해야 통신이 가능하다
- HW
  - 장비 규칙
  - 신호 전달 속도
- Format
  - 신호의 형태
- Sequence
  - Handshake 방식
  - 신호 전달 순서
- SW 동작
  - 오류 검출을 위한 행동

## 프로토콜을 이해해야 하는 이유

- 완벽한 통신 Application 제작 가능
- 통신 App을 위한 Library 제작 가능
- 프로토콜 내용대로 수행하는 Server 구축 가능

> 네트워크 프로그래밍에서 프로토콜 내용에 대한 이해는 필수

# TCP / IP의 이해

## IP(Internet Protocol)

- 송신 호스트와 수신 호스트가 정보를 주고받는데 사용하는 규약
- 패킷 혹은 데이터그램이라고 하는 덩어리로 나뉘어 전송
- 비 신뢰성, 비 연결성

## IP Address

- 인터넷 상에 있는 컴퓨터의 고유한 주소

## 프로토콜의 한계

- 비 연결성
  - 패킷을 받을 대상이 없거나 해당 도착지의 주소가 불능 상태여도 패킷을 전송
- 비 신뢰성
  - 통신 도중 패킷이 사라질 수 있음
  - 패킷이 순서대로 도착하지 않을 수 있음

## TCP (Transmission Control Protocol)

- 전송 제어 프로토콜
- IP의 핵심 프로토콜 중 하나
- 연결 지향 (3 way handshake)
- 데이터 전달 보증
- 순서 보증
- 신뢰할 수 있는 프로토콜

> 영상 / 음성 등 끊겨도 크게 상고나 없는 곳에서 사용

## UDP (User Datagram Protocol)

- 하얀 도화지에 비유 (기능이 거의 없음)
- 데이터 전달, 순서 보장 X
- 속도가 빠르다 (제약이 없기 때문에)
- 최신 HTTP에서는 UDP를 채택

# Port

- 동시 다발적 통신을 위한 가상의 문

## Port 사용예시

- IP를 통해, 어떤 컴퓨팅 장치가 통신을 할 지 결정이 된다
- 각 Node의 어떤 App에서 처리를 할 지 결정을 짓는데 Port가 사용된다
- 웹 서비스에서, 어떤 서비스를 선택할 지 포트번호에 따라 서버를 선택할 수 있다

## Port Number 구분

### Well-known Port Number (0~1023)

- Document에서 Well-known은 예약된이라는 뜻으로 쓰인다
- 80 / 443 : HTTP / HTTPS
- 22 : FTP / SSH

### Registered Port (1024~49151)

- 여러 Tool이 쓰는 포트들
- 3306 : MySQL
- 8080 : HTTP 대체용

### Dynamic Port (49152~65535)

- 필요할 때 마다 임의의 번호를 사용하는 곳

# Ethernet

## MAC 주소

- 기기마다 갖고 있는 고유 번호
- 네트워크에서 기기를 구분하는 주소

![MAC 주소](MAC%20주소.png)

## Ethernet 통신방법

- LAN 통신의 표준 (IEEE 802.3)
  - LAN 통신은 이더넷 말고, 토큰링, FDDI등 존재는 한다
  - LAN 규모의 통신은 거의 다 이더넷
- 이더넷이란?
  - 프로토콜 : CSMA / CD
  - 장비 : 이더넷 카드
  - 통신방법 : 이더넷 케이블

## Ethernet Card / NIC

- NIC (Network Interface Controller)
- 이더넷 카드
- 랜카드
- 컴퓨터와 네트워크를 연결시키기 위한 카드
- 대부분 메인보드에 내장되어 있다

# Ethernet 케이블

## 전송 속도

### Bit rate

- per second
- 초 bit당 몇 bit를 전송하는 지
- 단위는 bps

## 대역폭

- 주파수 개념일 때 대역폭
  - 최대와 최소 주파수의 폭
  - 폭이 넓을수록 정보를 한꺼번에 실을 수 있는 양이 커진다
- 통신에서 대역폭
  - 한번에 데이터를 전송할 수 있는 양

## UTP 케이블 (Unshielded Twisted-Pair Cable)

- 이더넷의 주류를 이루는 케이블
- RJ45 커넥터 사용

## STP 케이블 (Shielded Twisted-Pair Cable)

- EMI (방해전파) 방지를 위한 호일을 한번 더 감은 고급 케이블

## 케이블 전송 스팩

- CAT 5e
  - 1Gbps (기가인터넷)
  - 100MHz 대역폭
- CAT 6
  - 1Gbps
  - 250MHz 대역폭
- CAT 7
  - 10Gbps
  - 600MHz 대역폭

## 케이블 종류

### UTP 케이블의 두가지 종류

- 다이렉트 케이블 (일반적으로 많이 사용)
- 크로스 케이블
- 잘못 사용하면 통신이 안된다

### Auto MDI

- 아무 케이블만 꽂아도, 잘 동작하는 기술
- 가정용 공유기와 PC들
  - Auto MDI 지원
- 임베디드 보드
  - Auto MDI 미지원

# CSMA / CD

## LAN에서 통신하는 방식

### 공유기 없이 LAN을 구성했을 경우

- 하나의 노드에서 다른 노드로 신호를 보낼 때 마다 모든 노드에 모두 같은 신호를 보낸다

### CSMA / CD 프로토콜 동작 방식

1. 현재 네트워크에 통신이 되고 있는지 체크
2. 사용가능할 때까지 랜덤한 시간 기다림
3. 통신이 안 되고 있다면 통신을 시작
4. 만약 충돌이 발생한다면, 랜덤한 시간 이후 재전송

- 링크된 노드가 많아질수록 더욱 통신속도는 느려짐

## 콜리젼 도메인

- 충돌이 발생할 수 있는 네트워크 범위
- LAN 네트워크는 모두 같은 콜리젼 도메인을 가진다
- 연결되는 기기가 많아 질 수록 콜리젼 확률이 올라간다
- 통신 효율이 떨어진다

# Ethernet 네트워크 장비

## 공유기 (Router)

### Home Router의 한계

- 중대형 사무실급 네트워크 구축이 힘들다
- Home Router는 대부분 포트가 적다
- 공유기를 여러개 다량으로 연결하면, 속도가 느려지고 / 안정성이 떨어진다
- 전용선 속도 커버 못함
- 네트워크 안정성 떨어짐

> 연결할 PC가 많아지면 공유기 대신 라우터 / 스위치 등 다른 네트워크 장비로 네트워크를 구축

## 리피터

- 통신거리로 인해 신호가 약해짐
- 신호를 읽고 다시 신호 세기 증가
- 잡음 제거
- 단독으로 잘 쓰지 않는다
- 다른 장치에 리피터 기능이 포함 되어있음

## 이더넷 허브

- 멀티포트 리피터 / 허브
- 연결된 신호를 보내면 모두 복사해서 전체에 전달해줌
- CSMA / CD 프로토콜을 사용
  - 모두 같은 콜리젼 도메인에 있게 된다
  - PC 연결수가 많을 수록 콜리젼 확률이 커진다

## 스위치

- 스위칭 허브
- 신호를 단순 복사해서 뿌리지 않는다
- 평소에 각 포트별 어떤 MAC이 연결되어 있는지 저장해둔다
- 신호 내용을 분석하여 어느 MAC을 찾는지 알아낸다
- MAC이 있는 포트에만 신호를 전달한다

> 콜리젼 확률이 대폭 축소된다

## 라우터

- 내부 네터워크에서 다른 네트워크로 나가는 출구 (Gateway)
- 스위치처럼 내부 네트워크 연결이 가능하다
- 내부 네트워크들과 외부 네트워크 연결이 가능하다
- OS가 있다

# 홈 네트워크 (Home Network)

- 가정 내 다양한 기기들이 상호간에 유 / 무선 네트워크를 통해 커뮤니케이션하고 외부에서 인터넷을 통해 접속이 가능한 환경을 구축하는 것

## 액세스 회선

- LAN을 인터네소가 연결하기 위한 회선
- Best Effort : 적당한 속도로 인터넷이 되게끔 지원한다

## 전용 회선

- 기업의 네트워크르 고속으로 ISP와 연결하기 위한 회선
- 특정 전송 속도를 보장
- 신뢰성이 높음

# 서버의 구성

## 서버

- Client들이 접속하여 쓸 수 있는 시스템
- 대부분 무중단 운영
- 대용량 트래픽 처리

## 특정 역할의 서버

- 각 서버는 역할이 존재
  - 웹 서버 : Client 들에게 HTTP 문서를 전달해주는 컴퓨터
  - DB 서버 : Client 들에게 DB를 관리하는 서버
  - 게임 서버 : Client 들의 게임 데이터를 관리 & 처리해주는 컴퓨터

## 하나의 PC를 개인용 PC, DB 서버, 파일 서버 및 게임서버로 활용할 경우

- PC를 계속 켜두어야 함
- 개인용 자료가 유출 될 수 있음
- 개인 PC에서 게임을 돌리면 모든 서버들 속도가 낮아짐

## 여러개의 서버를 하나의 PC

- 서버용 PC를 계속 켜두어야 함
- 컴퓨터 한대 비용
- 관리가 편하다
- 특정 서버에 부하가 걸리면 모든 서버에 영향을 미친다

...

## 로드 밸런싱

- 웹 서버 한대가 처리할 수 있는 트래픽
- 접속자가 많아지면 다음 문제로 성능 이슈 발생
  - 네트워크 회선 문제
  - SSD Read 성능 문제
- 웹서버를 여러대 두고, 분할로 접속하도록 L4 스위치를 구성하면 속도가 3배 빨라진다
- 하나의 웹 서버가 마비되어도 무중단 운영이 가능하다

# 클라우드

## 사무실 내 서버

- 서버는 무중단 운영이 기본
  - 고장이 발생하지 않아야 한다
  - 회선, bps 및 트래픽이 좋아야 한다
  - 정전으로 인해 전력이 나가는 일이 없어야 한다

## 전산실 운영

- 적정 온도 / 습도 유지
  - 항온항습시스템
  - 공기 여과기 필수
- UPS (비상전력 시스템) 설치
- 물리적 보안
- 서버 관리자
  - 3교대 3명
- 서버랙
  - 안정적인 전원 공급
  - 먼지 관리
- 사무실 월세

## IDC 업체

- 서버 보관 및 대여 업체

### 코로케이션

- IDC 업체에 서버 PC를 두고 공간을 빌리는 것

### 서버 호스팅

- 서비스 규모가 클 때
- IDC 업체에 서버 PC를 빌리는 것

### 웹 호스팅

- 서비스 규모가 작을 때
- IDC 업체에 서버 PC 중 일부를 빌리는 것

## 전산실 운영의 문제점

- 특정 일에만 트래픽이 몰리는 경우
- 이벤트르 할 경우를 대비해서 전산실 확장, 직원 채용하기 힘듬
  - 수강신청 / 게임출시 / 쇼핑몰 이벤트

## 가상화 기술

- 현대의 고성능 컴퓨터에서 시뮬레이션 SW 컴퓨터를 생성
- 시뮬레이션 환경이지만, 실제 컴퓨터와 똑같이 동작
- 사용자는 시뮬레이션인지 실제 컴퓨터인지 구분 어려움

## 클라우드 서비스

- 인터넷을 이용하여, 가상화된 시스템 리소스를 사용할 수 있는 것
- 자신의 컴퓨터가 아닌, 서버 컴퓨터 자원을 사용하는 기술
- 소비자가 서비스 신청시 컴퓨터를 하나 만들어 대여해줌
- 소비자는 서버용 / 개인용으로 PC 사용가능
- 초당 사용료 지급
- 전산 운영 비용을 줄일 수 있다
- 전산 인력 비용을 줄일 수 있다

## IaaS (Infrastructure as a Service)

- 인프라 대여
- 컴퓨팅 시스템을 가상화 환경으로 만들어서 서비스를 제공해주는 방식
  - ex) AWS EC2

## PaaS (Platform as a Service)

- 플랫폼 대여
- 빌드한 코드 올려서 동작 확인
- 바꿀 수 없는 기본 시스템이 구축되어 있는 상태에서 App개발 / 배포 / DB관리 등 가능한 상태의 시스템
  - ex) Google App Engine

## SaaS (Software as a Service)

- 소프트웨어 대여
- 서버에서 호스팅 방식으로 서비스 제공
  - ex) Office365, Dropbox, 네이버 클라우드

## AWS

- Black Friday, 추수감사절, 아마존 이벤트시 최고 트래픽 발생
- 트래픽 관리 노하우를 통애 AWS를 운영 시작

## 클라우드 서비스를 이용하면 장점

- 전산실 운영 비용을 아낄 수 있다
  - 월 정기 비용 : 다량의 서버관리자 급여 / 전기비 / 사무실 임대료 / 회선비용
  - 일시적 비용 : L4 스위치 / 방화벽 / 대당 서버 비용 / 랙 / 항온항습장치 / UPS
- 클라우드 이용시
  - 월 정기 비용 : 한 명의 서버관리자 급여 / 시스템 사용료
  - 일시적 비용 : 없음

## Auto Scailing

- 장비 없이 장비 세팅이 편함
  - 로드밸런싱이 몇 번의 클릭으로 이뤄짐
- 이용자에 따라 서버의 개수가 자동으로 조절 설정 가능
  - 트래픽이 많아지면, 서버의 수가 늘어남, 요금이 늘어남
  - 트래픽이 작아지면, 서버의 수가 줄어들어 요금이 줄어듬